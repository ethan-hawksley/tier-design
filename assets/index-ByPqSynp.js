(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const d of i)if(d.type==="childList")for(const a of d.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const d={};return i.integrity&&(d.integrity=i.integrity),i.referrerPolicy&&(d.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?d.credentials="include":i.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function s(i){if(i.ep)return;i.ep=!0;const d=t(i);fetch(i.href,d)}})();const r={title:"Tier List Title",tiers:[{id:0,label:"S",colour:"#ff7f80",items:[]},{id:1,label:"A",colour:"#ffc07f",items:[]},{id:2,label:"B",colour:"#ffdf7f",items:[]},{id:3,label:"C",colour:"#ffff7f",items:[]},{id:4,label:"D",colour:"#bfff7f",items:[]},{id:5,label:"F",colour:"#7fff7f",items:[]}],unrankedItems:[]};function h(e,n){const t=document.createElement("div");if(t.classList.add("draggable-item"),t.draggable=!0,"text"in e)t.textContent=e.text,t.classList.add("draggable-item-text");else if("src"in e){const s=document.createElement("img");s.src=e.src,t.replaceChildren(s)}return t.dataset.id=e.id.toString(),t.addEventListener("dragstart",s=>{s.dataTransfer.setData("text",e.id.toString())}),t.addEventListener("contextmenu",s=>{s.preventDefault(),n()}),t}function R(e,n,t){const s=document.createElement("div");s.classList.add("tier-row");const i=document.createElement("input");i.classList.add("tier-label"),i.style.backgroundColor=e.colour,i.value=e.label,i.addEventListener("change",()=>{const a={...e,label:i.value};n(a)}),i.addEventListener("contextmenu",a=>{a.preventDefault(),t()});const d=document.createElement("div");d.classList.add("ranked-items-row"),d.dataset.id=e.id.toString(),d.addEventListener("dragover",a=>{a.preventDefault()});for(let a=0;a<e.items.length;a++){const l=e.items[a],u=h(l,()=>{const o={...e,items:e.items.filter(c=>c.id!==l.id)};n(o)});d.append(u)}return s.append(i,d),s}function C(e,n){const t=document.createElement("div");t.classList.add("unranked-items-row"),t.addEventListener("dragover",s=>{s.preventDefault()});for(let s=0;s<e.length;s++){const i=e[s],d=h(i,()=>{const a=e.filter(l=>l.id!==i.id);n(a)});t.append(d)}return t}function f(e){const n=document.querySelector(e);if(!n)throw new Error("Element cannot be found");return n}function I(e,n){return[...e,n]}function b(e,n,t){return[...e.slice(0,t),n,...e.slice(t)]}function v(e,n,t){return[...e.slice(0,t),n,...e.slice(t+1)]}function N(e,n){return[...e.slice(0,n),...e.slice(n+1)]}const x=f("#tier-list-title"),S=f("#tier-list-container"),w=f("#unranked-items-container"),A=f("#add-text-button"),B=f("#add-images-button"),L=f("#images-input"),O=f("#add-tier-button");function m(){console.log("Rendering Tier List"),x.textContent=r.title;const e=document.createDocumentFragment();for(let t=0;t<r.tiers.length;t++){const s=r.tiers[t],i=R(s,d=>{r.tiers=v(r.tiers,d,t),m()},()=>{console.log("removing"),r.tiers=N(r.tiers,t),m()});e.append(i)}S.replaceChildren(e);const n=C(r.unrankedItems,t=>{r.unrankedItems=t,m()});w.replaceChildren(n)}x.addEventListener("keydown",e=>{e.key==="Enter"&&e.preventDefault()});x.addEventListener("blur",()=>{r.title=x.textContent,m()});const P=document.getElementById("app");P.addEventListener("drop",e=>{e.preventDefault();const n=e.target,t=n.closest(".ranked-items-row, .unranked-items-row");if(!t)return;const s=Number(e.dataTransfer.getData("text"));if(Number.isNaN(s))return;const i=r.tiers.findIndex(o=>o.items.some(c=>c.id===s)),d=Number(t?.dataset.id),a=r.tiers.findIndex(o=>o.id===d),l=i>=0?r.tiers[i].items.find(o=>o.id===s):r.unrankedItems.find(o=>o.id===s);if(!l)throw new Error("Tier Item unexpectedly missing");const u=n.closest(".draggable-item");if(!(u?.classList.contains("draggable-item")&&Number(u?.dataset.id)===s)){if(i>=0){const o=r.tiers[i],c={...o,items:o.items.filter(g=>g.id!==s)};r.tiers=v(r.tiers,c,i)}else r.unrankedItems=r.unrankedItems.filter(o=>o.id!==s);if(a>=0){const o=r.tiers[a];let c;if(u?.classList.contains("draggable-item")){const k=Number(u.dataset.id),p=o.items.findIndex(D=>D.id===k),E=u.getBoundingClientRect();e.clientX<E.x+E.width/2?c=b(o.items,l,p):c=b(o.items,l,p+1)}else c=I(o.items,l);const g={...o,items:c};r.tiers=v(r.tiers,g,a)}else if(u?.classList.contains("draggable-item")){const o=Number(u.dataset.id),c=r.unrankedItems.findIndex(p=>p.id===o),g=u.getBoundingClientRect();e.clientX<g.x+g.width/2?r.unrankedItems=b(r.unrankedItems,l,c):r.unrankedItems=b(r.unrankedItems,l,c+1)}else r.unrankedItems=I(r.unrankedItems,l);m()}});function T(e){return e.reduce((n,t)=>Math.max(t.id,n),-1/0)}function y(){const e=r.tiers.reduce((t,s)=>Math.max(T(s.items),t),0),n=T(r.unrankedItems);return Math.max(e,n)+1}A.addEventListener("click",()=>{const e=prompt("Enter text:");if(e){const n={id:y(),type:"text",text:e};r.unrankedItems=I(r.unrankedItems,n),m()}});B.addEventListener("click",()=>{L.click()});L.addEventListener("change",()=>{if(L.files){for(const e of L.files){const n={id:y(),type:"image",src:URL.createObjectURL(e)};r.unrankedItems=I(r.unrankedItems,n)}m()}});function M(){return r.tiers.reduce((n,t)=>Math.max(n,t.id),0)+1}O.addEventListener("click",()=>{const e=prompt("Enter label:");if(!e)return;const n=prompt("Enter colour code:");if(!n)return;const t={id:M(),label:e,colour:n,items:[]};r.tiers=I(r.tiers,t),m()});f("#tier-list").addEventListener("contextmenu",e=>{e.preventDefault()});w.addEventListener("contextmenu",e=>{e.preventDefault()});m();
